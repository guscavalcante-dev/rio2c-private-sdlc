/*!
 * GMaps.js v0.2.30
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2012, Gustavo Leon
 * Released under the MIT License.
 */
if(window.google&&window.google.maps)var GMaps=function(n){"use strict";var r=document,i=function(t,i){return"jQuery"in n&&i?$("#"+t.replace("#",""),i)[0]:r.getElementById(t.replace("#",""))},t=function t(n){var u=this,h=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],c=["mousemove","mouseout","mouseover"],y,g,nt,w,b,k,e,o,a,v,f,s,d;window.context_menu={};this.el=typeof n.el=="string"||typeof n.div=="string"?i(n.el||n.div,n.context):n.el||n.div;this.el.style.width=n.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=n.height||this.el.scrollHeight||this.el.offsetHeight;this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=n.zoom||15;y=n.markerClusterer;g=n.mapType?google.maps.MapTypeId[n.mapType.toUpperCase()]:google.maps.MapTypeId.ROADMAP;nt=new google.maps.LatLng(n.lat,n.lng);delete n.el;delete n.lat;delete n.lng;delete n.mapType;delete n.width;delete n.height;delete n.markerClusterer;var tt=n.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},rt=n.zoomControl||!0,ut=tt.style||"DEFAULT",ft=tt.position||"TOP_LEFT",et=n.panControl||!0,ot=n.mapTypeControl||!0,st=n.scaleControl||!0,ht=n.streetViewControl||!0,it=it||!0,l={},p={zoom:this.zoom,center:nt,mapTypeId:g},ct={panControl:et,zoomControl:rt,zoomControlOptions:{style:google.maps.ZoomControlStyle[ut],position:google.maps.ControlPosition[ft]},mapTypeControl:ot,scaleControl:st,streetViewControl:ht,overviewMapControl:it};for(n.disableDefaultUI!=!0&&(p=extend_object(p,ct)),l=extend_object(p,n),f=0;f<h.length;f++)delete l[h[f]];for(f=0;f<c.length;f++)delete l[c[f]];for(this.map=new google.maps.Map(this.el,l),y&&(this.markerClusterer=y.apply(this,[this.map])),w=function(n,t){var h="",e=window.context_menu[n],c,f,o,l,r,s,a,v,y;for(r in e)e.hasOwnProperty(r)&&(c=e[r],h+='<li><a id="'+n+"_"+r+'" href="#">'+c.title+"<\/a><\/li>");if(i("gmaps_context_menu")){for(f=i("gmaps_context_menu"),f.innerHTML=h,o=f.getElementsByTagName("a"),l=o.length,r=0;r<l;r++)s=o[r],a=function(i){i.preventDefault();e[this.id.replace(n+"_","")].action.apply(u,[t]);u.hideContextMenu()},google.maps.event.clearListeners(s,"click"),google.maps.event.addDomListenerOnce(s,"click",a,!1);v=u.el.offsetLeft+t.pixel.x-15;y=u.el.offsetTop+t.pixel.y-15;f.style.left=v+"px";f.style.top=y+"px";f.style.display="block"}},b=function(n,t){if(n==="marker"){t.pixel={};var i=new google.maps.OverlayView;i.setMap(u.map);i.draw=function(){var r=i.getProjection(),u=t.marker.getPosition();t.pixel=r.fromLatLngToContainerPixel(u);w(n,t)}}else w(n,t)},this.setContextMenu=function(n){var f,u,t,e;window.context_menu[n.control]={};for(f in n.options)n.options.hasOwnProperty(f)&&(u=n.options[f],window.context_menu[n.control][u.name]={title:u.title,action:u.action});t=r.createElement("ul");t.id="gmaps_context_menu";t.style.display="none";t.style.position="absolute";t.style.minWidth="100px";t.style.background="white";t.style.listStyle="none";t.style.padding="8px";t.style.boxShadow="2px 2px 6px #ccc";r.body.appendChild(t);e=i("gmaps_context_menu");google.maps.event.addDomListener(e,"mouseout",function(n){n.relatedTarget&&this.contains(n.relatedTarget)||window.setTimeout(function(){e.style.display="none"},400)},!1)},this.hideContextMenu=function(){var n=i("gmaps_context_menu");n&&(n.style.display="none")},k=function(t,i){google.maps.event.addListener(t,i,function(t){t==undefined&&(t=this);n[i].apply(this,[t]);u.hideContextMenu()})},e=0;e<h.length;e++)o=h[e],o in n&&k(this.map,o);for(e=0;e<c.length;e++)o=c[e],o in n&&k(this.map,o);google.maps.event.addListener(this.map,"rightclick",function(t){n.rightclick&&n.rightclick.apply(this,[t]);window.context_menu.map!=undefined&&b("map",t)});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){for(var t=[],i=this.markers.length,n=0;n<i;n++)t.push(this.markers[n].getPosition());this.fitLatLngBounds(t)};this.fitLatLngBounds=function(n){for(var r=n.length,i=new google.maps.LatLngBounds,t=0;t<r;t++)i.extend(n[t]);this.map.fitBounds(i)};this.setCenter=function(n,t,i){this.map.panTo(new google.maps.LatLng(n,t));i&&i()};this.getElement=function(){return this.el};this.zoomIn=function(n){this.zoom=this.map.getZoom()+n;this.map.setZoom(this.zoom)};this.zoomOut=function(n){this.zoom=this.map.getZoom()-n;this.map.setZoom(this.zoom)};a=[];for(v in this.map)typeof this.map[v]!="function"||this[v]||a.push(v);for(f=0;f<a.length;f++)(function(n,t,i){n[i]=function(){return t[i].apply(t,arguments)}})(this,this.map,a[f]);this.createControl=function(n){var t=r.createElement("div"),i,u;t.style.cursor="pointer";t.style.fontFamily="Arial, sans-serif";t.style.fontSize="13px";t.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(i in n.style)t.style[i]=n.style[i];n.id&&(t.id=n.id);n.classes&&(t.className=n.classes);n.content&&(t.innerHTML=n.content);for(u in n.events)(function(t,i){google.maps.event.addDomListener(t,i,function(){n.events[i].apply(this,[this])})})(t,u);return t.index=1,t};this.addControl=function(n){var i=google.maps.ControlPosition[n.position.toUpperCase()],t;return delete n.position,t=this.createControl(n),this.controls.push(t),this.map.controls[i].push(t),t};this.createMarker=function(n){var o,t,u,f,e,i;if(n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")||n.position){var r=this,s=n.details,h=n.fences,c=n.outside,l={position:new google.maps.LatLng(n.lat,n.lng),map:null};if(delete n.lat,delete n.lng,delete n.fences,delete n.outside,o=extend_object(l,n),t=new google.maps.Marker(o),t.fences=h,n.infoWindow)for(t.infoWindow=new google.maps.InfoWindow(n.infoWindow),u=["closeclick","content_changed","domready","position_changed","zindex_changed"],i=0;i<u.length;i++)(function(t,i){google.maps.event.addListener(t,i,function(t){n.infoWindow[i]&&n.infoWindow[i].apply(this,[t])})})(t.infoWindow,u[i]);for(f=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],e=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],i=0;i<f.length;i++)(function(t,i){google.maps.event.addListener(t,i,function(){n[i]&&n[i].apply(this,[this])})})(t,f[i]);for(i=0;i<e.length;i++)(function(t,i,r){google.maps.event.addListener(i,r,function(i){i.pixel||(i.pixel=t.getProjection().fromLatLngToPoint(i.latLng));n[r]&&n[r].apply(this,[i])})})(this.map,t,e[i]);return google.maps.event.addListener(t,"click",function(){this.details=s;n.click&&n.click.apply(this,[this]);t.infoWindow&&(r.hideInfoWindows(),t.infoWindow.open(r.map,t))}),google.maps.event.addListener(t,"rightclick",function(t){t.marker=this;n.rightclick&&n.rightclick.apply(this,[t]);window.context_menu.marker!=undefined&&b("marker",t)}),(n.dragend||t.fences)&&google.maps.event.addListener(t,"dragend",function(){t.fences&&r.checkMarkerGeofence(t,function(n,t){c(n,t)})}),t}throw"No latitude or longitude defined";};this.addMarker=function(n){var t;if(n.hasOwnProperty("gm_accessors_"))t=n;else if(n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")||n.position)t=this.createMarker(n);else throw"No latitude or longitude defined";return t.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(t),this.markers.push(t),t};this.addMarkers=function(n){for(var t=0,i;i=n[t];t++)this.addMarker(i);return this.markers};this.hideInfoWindows=function(){for(var t=0,n;n=this.markers[t];t++)n.infoWindow&&n.infoWindow.close()};this.removeMarker=function(n){for(var t=0;t<this.markers.length;t++)if(this.markers[t]===n){this.markers[t].setMap(null);this.markers.splice(t,1);break}return n};this.removeMarkers=function(n){for(var i,n=n||this.markers,t=0;t<this.markers.length;t++)this.markers[t]===n[t]&&this.markers[t].setMap(null);for(i=[],t=0;t<this.markers.length;t++)this.markers[t].getMap()!=null&&i.push(this.markers[t]);this.markers=i};this.drawOverlay=function(n){var t=new google.maps.OverlayView,i;return t.setMap(u.map),i=!0,n.auto_show!=null&&(i=n.auto_show),t.onAdd=function(){var i=r.createElement("div"),e,o,f,u;for(i.style.borderStyle="none",i.style.borderWidth="0px",i.style.position="absolute",i.style.zIndex=100,i.innerHTML=n.content,t.el=i,e=this.getPanes(),n.layer||(n.layer="overlayLayer"),o=e[n.layer],o.appendChild(i),f=["contextmenu","DOMMouseScroll","dblclick","mousedown"],u=0;u<f.length;u++)(function(n,t){google.maps.event.addDomListener(n,t,function(n){navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all?(n.cancelBubble=!0,n.returnValue=!1):n.stopPropagation()})})(i,f[u]);google.maps.event.trigger(this,"ready")},t.draw=function(){var s=this.getProjection(),u=s.fromLatLngToDivPixel(new google.maps.LatLng(n.lat,n.lng));n.horizontalOffset=n.horizontalOffset||0;n.verticalOffset=n.verticalOffset||0;var r=t.el,f=r.children[0],e=f.clientHeight,o=f.clientWidth;switch(n.verticalAlign){case"top":r.style.top=u.y-e+n.verticalOffset+"px";break;default:case"middle":r.style.top=u.y-e/2+n.verticalOffset+"px";break;case"bottom":r.style.top=u.y+n.verticalOffset+"px"}switch(n.horizontalAlign){case"left":r.style.left=u.x-o+n.horizontalOffset+"px";break;default:case"center":r.style.left=u.x-o/2+n.horizontalOffset+"px";break;case"right":r.style.left=u.x+n.horizontalOffset+"px"}r.style.display=i?"block":"none";i||n.show.apply(this,[r])},t.onRemove=function(){var i=t.el;n.remove?n.remove.apply(this,[i]):(t.el.parentNode.removeChild(t.el),t.el=null)},u.overlays.push(t),t};this.removeOverlay=function(n){for(var t=0;t<this.overlays.length;t++)if(this.overlays[t]===n){this.overlays[t].setMap(null);this.overlays.splice(t,1);break}};this.removeOverlays=function(){for(var n=0,t;t=u.overlays[n];n++)t.setMap(null);u.overlays=[]};this.drawPolyline=function(n){var f=[],i=n.path,e,o,t,r,s,u;if(i.length)if(i[0][0]===undefined)f=i;else for(e=0;o=i[e];e++)f.push(new google.maps.LatLng(o[0],o[1]));for(t={map:this.map,path:f,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight,geodesic:n.geodesic,clickable:!0,editable:!1,visible:!0},n.hasOwnProperty("clickable")&&(t.clickable=n.clickable),n.hasOwnProperty("editable")&&(t.editable=n.editable),n.hasOwnProperty("icons")&&(t.icons=n.icons),n.hasOwnProperty("zIndex")&&(t.zIndex=n.zIndex),r=new google.maps.Polyline(t),s=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],u=0;u<s.length;u++)(function(t,i){google.maps.event.addListener(t,i,function(t){n[i]&&n[i].apply(this,[t])})})(r,s[u]);return this.polylines.push(r),r};this.removePolyline=function(n){for(var t=0;t<this.polylines.length;t++)if(this.polylines[t]===n){this.polylines[t].setMap(null);this.polylines.splice(t,1);break}};this.removePolylines=function(){for(var n=0,t;t=u.polylines[n];n++)t.setMap(null);u.polylines=[]};this.drawCircle=function(n){var t,r,i;for(n=extend_object({map:this.map,center:new google.maps.LatLng(n.lat,n.lng)},n),delete n.lat,delete n.lng,t=new google.maps.Circle(n),r=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<r.length;i++)(function(t,i){google.maps.event.addListener(t,i,function(t){n[i]&&n[i].apply(this,[t])})})(t,r[i]);return this.polygons.push(t),t};this.drawRectangle=function(n){var u,t,r,i;for(n=extend_object({map:this.map},n),u=new google.maps.LatLngBounds(new google.maps.LatLng(n.bounds[0][0],n.bounds[0][1]),new google.maps.LatLng(n.bounds[1][0],n.bounds[1][1])),n.bounds=u,t=new google.maps.Rectangle(n),r=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<r.length;i++)(function(t,i){google.maps.event.addListener(t,i,function(t){n[i]&&n[i].apply(this,[t])})})(t,r[i]);return this.polygons.push(t),t};this.drawPolygon=function(n){var r=!1,t,u,i;for(n.hasOwnProperty("useGeoJSON")&&(r=n.useGeoJSON),delete n.useGeoJSON,n=extend_object({map:this.map},n),r==!1&&(n.paths=[n.paths.slice(0)]),n.paths.length>0&&n.paths[0].length>0&&(n.paths=array_flat(array_map(n.paths,arrayToLatLng,r))),t=new google.maps.Polygon(n),u=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],i=0;i<u.length;i++)(function(t,i){google.maps.event.addListener(t,i,function(t){n[i]&&n[i].apply(this,[t])})})(t,u[i]);return this.polygons.push(t),t};this.removePolygon=function(n){for(var t=0;t<this.polygons.length;t++)if(this.polygons[t]===n){this.polygons[t].setMap(null);this.polygons.splice(t,1);break}};this.removePolygons=function(){for(var n=0,t;t=u.polygons[n];n++)t.setMap(null);u.polygons=[]};this.getFromFusionTables=function(n){var i=n.events,r,t,u;delete n.events;r=n;t=new google.maps.FusionTablesLayer(r);for(u in i)(function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})})(t,u);return this.layers.push(t),t};this.loadFromFusionTables=function(n){var t=this.getFromFusionTables(n);return t.setMap(this.map),t};this.getFromKML=function(n){var f=n.url,i=n.events,r,t,u;delete n.url;delete n.events;r=n;t=new google.maps.KmlLayer(f,r);for(u in i)(function(n,t){google.maps.event.addListener(n,t,function(n){i[t].apply(this,[n])})})(t,u);return this.layers.push(t),t};this.loadFromKML=function(n){var t=this.getFromKML(n);return t.setMap(this.map),t};this.getRoutes=function(n){var r,t,i,u;switch(n.travelMode){case"bicycling":s=google.maps.TravelMode.BICYCLING;break;case"transit":s=google.maps.TravelMode.TRANSIT;break;case"driving":s=google.maps.TravelMode.DRIVING;break;default:s=google.maps.TravelMode.WALKING}d=n.unitSystem==="imperial"?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;r={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]};t=extend_object(r,n);t.origin=new google.maps.LatLng(n.origin[0],n.origin[1]);t.destination=new google.maps.LatLng(n.destination[0],n.destination[1]);t.travelMode=s;t.unitSystem=d;delete t.callback;i=this;u=new google.maps.DirectionsService;u.route(t,function(t,r){if(r===google.maps.DirectionsStatus.OK)for(var u in t.routes)t.routes.hasOwnProperty(u)&&i.routes.push(t.routes[u]);n.callback&&n.callback(i.routes)})};this.removeRoutes=function(){this.routes=[]};this.getElevations=function(n){var t,i,r;n=extend_object({locations:[],path:!1,samples:256},n);n.locations.length>0&&n.locations[0].length>0&&(n.locations=array_flat(array_map([n.locations],arrayToLatLng,!1)));t=n.callback;delete n.callback;i=new google.maps.ElevationService;n.path?(r={path:n.locations,samples:n.samples},i.getElevationAlongPath(r,function(n,i){t&&typeof t=="function"&&t(n,i)})):(delete n.path,delete n.samples,i.getElevationForLocations(n,function(n,i){t&&typeof t=="function"&&t(n,i)}))};this.cleanRoute=this.removePolylines;this.drawRoute=function(n){var t=this;this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,unitSystem:n.unitSystem,callback:function(i){i.length>0&&(t.drawPolyline({path:i[i.length-1].overview_path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.callback&&n.callback(i[i.length-1]))}})};this.travelRoute=function(n){var r,t,i;if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,callback:function(t){var i,f,r,u;if(t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step&&(i=t[t.length-1],i.legs.length>0))for(f=i.legs[0].steps,r=0;u=f[r];r++)u.step_number=r,n.step(u,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(r=n.route.legs[0].steps,t=0;i=r[t];t++)i.step_number=t,n.step(i)};this.drawSteppedRoute=function(n){var r,t,i;if(n.origin&&n.destination)this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,callback:function(t){var i,e,r,f;if(t.length>0&&n.start&&n.start(t[t.length-1]),t.length>0&&n.step&&(i=t[t.length-1],i.legs.length>0))for(e=i.legs[0].steps,r=0;f=e[r];r++)f.step_number=r,u.drawPolyline({path:f.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(f,i.legs[0].steps.length-1);t.length>0&&n.end&&n.end(t[t.length-1])}});else if(n.route&&n.route.legs.length>0)for(r=n.route.legs[0].steps,t=0;i=r[t];t++)i.step_number=t,u.drawPolyline({path:i.path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}),n.step(i)};this.checkGeofence=function(n,t,i){return i.containsLatLng(new google.maps.LatLng(n,t))};this.checkMarkerGeofence=function(n,t){var i,r,f;if(n.fences)for(i=0;r=n.fences[i];i++)f=n.getPosition(),u.checkGeofence(f.lat(),f.lng(),r)||t(n,r)};this.addLayer=function(n,t){var i,r,u;t=t||{};switch(n){case"weather":this.singleLayers.weather=i=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=i=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=i=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=i=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=i=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=i=new google.maps.panoramio.PanoramioLayer;i.setTag(t.filter);delete t.filter;t.click&&google.maps.event.addListener(i,"click",function(n){t.click(n);delete t.click});break;case"places":this.singleLayers.places=i=new google.maps.places.PlacesService(this.map);(t.search||t.nearbySearch)&&(r={bounds:t.bounds||null,keyword:t.keyword||null,location:t.location||null,name:t.name||null,radius:t.radius||null,rankBy:t.rankBy||null,types:t.types||null},t.search&&i.search(r,t.search),t.nearbySearch&&i.nearbySearch(r,t.nearbySearch));t.textSearch&&(u={bounds:t.bounds||null,location:t.location||null,query:t.query||null,radius:t.radius||null},i.textSearch(u,t.textSearch))}if(i!==undefined)return typeof i.setOptions=="function"&&i.setOptions(t),typeof i.setMap=="function"&&i.setMap(this.map),i};this.removeLayer=function(n){this.singleLayers[n]!==undefined&&(this.singleLayers[n].setMap(null),delete this.singleLayers[n])};this.toImage=function(n){var n=n||{},i={},r,u;if(i.size=n.size||[this.el.clientWidth,this.el.clientHeight],i.lat=this.getCenter().lat(),i.lng=this.getCenter().lng(),this.markers.length>0)for(i.markers=[],r=0;r<this.markers.length;r++)i.markers.push({lat:this.markers[r].getPosition().lat(),lng:this.markers[r].getPosition().lng()});return this.polylines.length>0&&(u=this.polylines[0],i.polyline={},i.polyline.path=google.maps.geometry.encoding.encodePath(u.getPath()),i.polyline.strokeColor=u.strokeColor,i.polyline.strokeOpacity=u.strokeOpacity,i.polyline.strokeWeight=u.strokeWeight),t.staticMapURL(i)};this.addMapType=function(n,t){if(t.hasOwnProperty("getTileUrl")&&typeof t.getTileUrl=="function"){t.tileSize=t.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(t);this.map.mapTypes.set(n,i)}else throw"'getTileUrl' function required";};this.addOverlayMapType=function(n){if(n.hasOwnProperty("getTile")&&typeof n.getTile=="function"){var t=n.index;delete n.index;this.map.overlayMapTypes.insertAt(t,n)}else throw"'getTile' function required";};this.removeOverlayMapType=function(n){this.map.overlayMapTypes.removeAt(n)};this.addStyle=function(n){var t=new google.maps.StyledMapType(n.styles,n.styledMapName);this.map.mapTypes.set(n.mapTypeId,t)};this.setStyle=function(n){this.map.setMapTypeId(n)};this.createPanorama=function(n){return n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")||(n.lat=this.getCenter().lat(),n.lng=this.getCenter().lng()),this.panorama=t.createPanorama(n),this.map.setStreetView(this.panorama),this.panorama}};return t.createPanorama=function(n){var e=i(n.el,n.context),r,u,f,t;for(n.position=new google.maps.LatLng(n.lat,n.lng),delete n.el,delete n.context,delete n.lat,delete n.lng,r=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],u=extend_object({visible:!0},n),t=0;t<r.length;t++)delete u[r[t]];for(f=new google.maps.StreetViewPanorama(e,u),t=0;t<r.length;t++)(function(t,i){google.maps.event.addListener(t,i,function(){n[i]&&n[i].apply(this)})})(f,r[t]);return f},t.Route=function(n){this.map=n.map;this.route=n.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight}).getPath();this.back=function(){var n,t;if(this.step_count>0){this.step_count--;n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.pop()}};this.forward=function(){var n,t;if(this.step_count<this.steps_length){n=this.route.legs[0].steps[this.step_count].path;for(t in n)n.hasOwnProperty(t)&&this.polyline.push(n[t]);this.step_count++}}},t.geolocate=function(n){var t=n.always||n.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){n.success(i);t&&t()},function(i){n.error(i);t&&t()},n.options):(n.not_supported(),t&&t())},t.geocode=function(n){this.geocoder=new google.maps.Geocoder;var t=n.callback;n.hasOwnProperty("lat")&&n.hasOwnProperty("lng")&&(n.latLng=new google.maps.LatLng(n.lat,n.lng));delete n.lat;delete n.lng;delete n.callback;this.geocoder.geocode(n,function(n,i){t(n,i)})},t.staticMapURL=function(n){function p(n,t){if(n[0]==="#"&&(n=n.replace("#","0x"),t)){if(t=parseFloat(t),t=Math.min(1,Math.max(t,0)),t===0)return"0x00000000";t=(t*255).toString(16);t.length===1&&(t+=t);n=n.slice(0,8)+t}return n}var i=[],t,c="http://maps.googleapis.com/maps/api/staticmap",e,r,v,f,y,o,u,l,s,w,b,h,a,k;n.url&&(c=n.url,delete n.url);c+="?";e=n.markers;delete n.markers;!e&&n.marker&&(e=[n.marker],delete n.marker);r=n.polyline;delete n.polyline;n.center?(i.push("center="+n.center),delete n.center):n.address?(i.push("center="+n.address),delete n.address):n.lat?(i.push(["center=",n.lat,",",n.lng].join("")),delete n.lat,delete n.lng):n.visible&&(v=encodeURI(n.visible.join("|")),i.push("visible="+v));f=n.size;f?(f.join&&(f=f.join("x")),delete n.size):f="630x300";i.push("size="+f);n.zoom||(n.zoom=15);y=n.hasOwnProperty("sensor")?!!n.sensor:!0;delete n.sensor;i.push("sensor="+y);for(o in n)n.hasOwnProperty(o)&&i.push(o+"="+n[o]);if(e)for(s=0;t=e[s];s++)u=[],t.size&&t.size!=="normal"?u.push("size:"+t.size):t.icon&&u.push("icon:"+encodeURI(t.icon)),t.color&&u.push("color:"+t.color.replace("#","0x")),t.label&&u.push("label:"+t.label[0].toUpperCase()),l=t.address?t.address:t.lat+","+t.lng,u.length||s===0?(u.push(l),u=u.join("|"),i.push("markers="+encodeURI(u))):(u=i.pop()+encodeURI("|"+l),i.push(u));if(r){if(t=r,r=[],t.strokeWeight&&r.push("weight:"+parseInt(t.strokeWeight,10)),t.strokeColor&&(w=p(t.strokeColor,t.strokeOpacity),r.push("color:"+w)),t.fillColor&&(b=p(t.fillColor,t.fillOpacity),r.push("fillcolor:"+b)),h=t.path,h.join)for(a=0;k=h[a];a++)r.push(k.join(","));else r.push("enc:"+h);r=r.join("|");i.push("path="+encodeURI(r))}return i=i.join("&"),c+i},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var n,r=new google.maps.LatLngBounds,u=this.getPaths(),t,i=0;i<u.getLength();i++)for(t=u.getAt(i),n=0;n<t.getLength();n++)r.extend(t.getAt(n));return r}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(n){var o=this.getBounds(),u,s,f,i,t,r;if(o!==null&&!o.contains(n))return!1;for(u=!1,s=this.getPaths().getLength(),f=0;f<s;f++){var e=this.getPaths().getAt(f),h=e.getLength(),c=h-1;for(i=0;i<h;i++)t=e.getAt(i),r=e.getAt(c),(t.lng()<n.lng()&&r.lng()>=n.lng()||r.lng()<n.lng()&&t.lng()>=n.lng())&&t.lat()+(n.lng()-t.lng())/(r.lng()-t.lng())*(r.lat()-t.lat())<n.lat()&&(u=!u),c=i}return u}),google.maps.LatLngBounds.prototype.containsLatLng=function(n){return this.contains(n)},google.maps.Marker.prototype.setFences=function(n){this.fences=n},google.maps.Marker.prototype.addFence=function(n){this.fences.push(n)},t}(undefined),coordsToLatLngs=function(n,t){var i=n[0],r=n[1];return t&&(i=n[1],r=n[0]),new google.maps.LatLng(i,r)},arrayToLatLng=function arrayToLatLng(n,t){for(var i=0;i<n.length;i++)n[i]=n[i].length>0&&typeof n[i][0]!="number"?arrayToLatLng(n[i],t):coordsToLatLngs(n[i],t);return n},extend_object=function(n,t){if(n===t)return n;for(var i in t)n[i]=t[i];return n},replace_object=function(n,t){if(n===t)return n;for(var i in t)n[i]!=undefined&&(n[i]=t[i]);return n},array_map=function(n,t){var u=Array.prototype.slice.call(arguments,2),r,f,i;if(Array.prototype.map&&n.map===Array.prototype.map)return Array.prototype.map.call(n,function(n){return callback_params=u,callback_params.splice(0,0,n),t.apply(this,callback_params)});for(r=[],f=n.length,i=0;i<f;i++)callback_params=u,callback_params=callback_params.splice(0,0,n[i]),r.push(t.apply(this,callback_params));return r},array_flat=function(n){new_array=[];for(var t=0;t<n.length;t++)new_array=new_array.concat(n[t]);return new_array};