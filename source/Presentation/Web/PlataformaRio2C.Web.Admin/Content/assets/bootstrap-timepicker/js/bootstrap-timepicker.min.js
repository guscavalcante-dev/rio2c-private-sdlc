"use strict";!function(n){var t=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.timepicker.defaults,i,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.open=!1;this.init()};t.prototype={constructor:t,init:function(){if(this.$element.parent().hasClass("input-group")){this.$element.parent(".input-group").find(".btn").on("click",n.proxy(this.showWidget,this));this.$element.on({focus:n.proxy(this.highlightUnit,this),click:n.proxy(this.highlightUnit,this),keypress:n.proxy(this.elementKeypress,this),blur:n.proxy(this.blurElement,this)})}else if(this.template)this.$element.on({focus:n.proxy(this.showWidget,this),click:n.proxy(this.showWidget,this),blur:n.proxy(this.blurElement,this)});else this.$element.on({focus:n.proxy(this.highlightUnit,this),click:n.proxy(this.highlightUnit,this),keypress:n.proxy(this.elementKeypress,this),blur:n.proxy(this.blurElement,this)});this.$widget=n(this.getTemplate()).appendTo("body");this.$widget.on("click",n.proxy(this.widgetClick,this));if(this.showInputs)this.$widget.find("input").on({click:function(){this.select()},keypress:n.proxy(this.widgetKeypress,this),change:n.proxy(this.updateFromWidgetInputs,this)});this.setDefaultTime(this.defaultTime)},showWidget:function(t){if(t.stopPropagation(),t.preventDefault(),!this.open){this.$element.trigger("show");this.disableFocus&&this.$element.blur();var i=n.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.updateFromElementVal();n("html").trigger("click.timepicker.data-api").one("click.timepicker.data-api",n.proxy(this.hideWidget,this));if(this.template==="modal")this.$widget.modal("show").on("hidden",n.proxy(this.hideWidget,this));else this.$widget.css({top:i.top+i.height,left:i.left}),this.open||this.$widget.addClass("open");this.open=!0;this.$element.trigger("shown")}},hideWidget:function(){this.$element.trigger("hide");this.template==="modal"?this.$widget.modal("hide"):this.$widget.removeClass("open");this.open=!1;this.$element.trigger("hidden")},widgetClick:function(t){t.stopPropagation();t.preventDefault();var i=n(t.target).closest("a").data("action");i&&(this[i](),this.update())},widgetKeypress:function(t){var i=n(t.target).closest("input").attr("name");switch(t.keyCode){case 9:this.showMeridian?i=="meridian"&&this.hideWidget():this.showSeconds?i=="second"&&this.hideWidget():i=="minute"&&this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(i){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.update();break;case 40:switch(i){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.update()}},elementKeypress:function(n){var t=this.$element.get(0);switch(n.keyCode){case 9:this.updateFromElementVal();this.showMeridian?this.highlightedUnit!="meridian"&&(n.preventDefault(),this.highlightNextUnit()):this.showSeconds?this.highlightedUnit!="second"&&(n.preventDefault(),this.highlightNextUnit()):this.highlightedUnit!="minute"&&(n.preventDefault(),this.highlightNextUnit());break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.updateElement()}n.keyCode!==0&&n.keyCode!==8&&n.keyCode!==9&&n.keyCode!==46&&n.preventDefault()},setValues:function(n){var i,t;this.showMeridian?(i=n.split(" "),t=i[0].split(":"),this.meridian=i[1]):t=n.split(":");this.hour=parseInt(t[0],10);this.minute=parseInt(t[1],10);this.second=parseInt(t[2],10);isNaN(this.hour)&&(this.hour=0);isNaN(this.minute)&&(this.minute=0);this.showMeridian?(this.hour>12?this.hour=12:this.hour<1&&(this.hour=1),this.meridian=="am"||this.meridian=="a"?this.meridian="AM":(this.meridian=="pm"||this.meridian=="p")&&(this.meridian="PM"),this.meridian!="AM"&&this.meridian!="PM"&&(this.meridian="AM")):this.hour>=24?this.hour=23:this.hour<0&&(this.hour=0);this.minute<0?this.minute=0:this.minute>=60&&(this.minute=59);this.showSeconds&&(isNaN(this.second)?this.second=0:this.second<0?this.second=0:this.second>=60&&(this.second=59));this.$element.val()!=""&&this.updateElement();this.updateWidget()},setMeridian:function(n){n=="a"||n=="am"||n=="AM"?this.meridian="AM":n=="p"||n=="pm"||n=="PM"?this.meridian="PM":this.updateWidget();this.updateElement()},setDefaultTime:function(n){if(n){if(n==="current"){var i=new Date,t=i.getHours(),u=Math.floor(i.getMinutes()/this.minuteStep)*this.minuteStep,f=Math.floor(i.getSeconds()/this.secondStep)*this.secondStep,r="AM";this.showMeridian&&(t===0?t=12:t>=12?(t>12&&(t=t-12),r="PM"):r="AM");this.hour=t;this.minute=u;this.second=f;this.meridian=r}else n==="value"?this.setValues(this.$element.val()):this.setValues(n);this.$element.val()!=""&&this.updateElement();this.updateWidget()}else this.hour=0,this.minute=0,this.second=0},formatTime:function(n,t,i,r){return n=n<10?"0"+n:n,t=t<10?"0"+t:t,i=i<10?"0"+i:i,n+":"+t+(this.showSeconds?":"+i:"")+(this.showMeridian?" "+r:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(n){this.setValues(n);this.update()},update:function(){this.updateElement();this.updateWidget()},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal()},updateElement:function(){var n=this.getTime();this.$element.val(n).change();switch(this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian()}},updateWidget:function(){this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour),this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour),this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))},updateFromElementVal:function(){var n=this.$element.val();n&&(this.setValues(n),this.updateWidget())},updateFromWidgetInputs:function(){var t=n("input.bootstrap-timepicker-hour",this.$widget).val()+":"+n("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+n("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+n("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(t)},getCursorPosition:function(){var n=this.$element.get(0),t,i;return"selectionStart"in n?n.selectionStart:document.selection?(n.focus(),t=document.selection.createRange(),i=document.selection.createRange().text.length,t.moveStart("character",-n.value.length),t.text.length-i):void 0},highlightUnit:function(){var n=this.$element.get(0);this.position=this.getCursorPosition();this.position>=0&&this.position<=2?this.highlightHour():this.position>=3&&this.position<=5?this.highlightMinute():this.position>=6&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():this.position>=9&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.highlightMeridian();break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){this.highlightedUnit="hour";this.$element.get(0).setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute";this.$element.get(0).setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second";this.$element.get(0).setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian";this.showSeconds?this.$element.get(0).setSelectionRange(9,11):this.$element.get(0).setSelectionRange(6,8)},incrementHour:function(){if(this.showMeridian)if(this.hour===11)this.toggleMeridian();else if(this.hour===12)return this.hour=1;if(this.hour===23)return this.hour=0;this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(this.hour===1)return this.hour=12;this.hour===12&&this.toggleMeridian()}if(this.hour===0)return this.hour=23;this.hour=this.hour-1},incrementMinute:function(){var n=this.minute+this.minuteStep-this.minute%this.minuteStep;n>59?(this.incrementHour(),this.minute=n-60):this.minute=n},decrementMinute:function(){var n=this.minute-this.minuteStep;n<0?(this.decrementHour(),this.minute=n+60):this.minute=n},incrementSecond:function(){var n=this.second+this.secondStep-this.second%this.secondStep;n>59?(this.incrementMinute(),this.second=n-60):this.second=n},decrementSecond:function(){var n=this.second-this.secondStep;n<0?(this.decrementMinute(),this.second=n+60):this.second=n},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},getTemplate:function(){var n,t;if(this.options.templates[this.options.template])return this.options.templates[this.options.template];if(this.showInputs)var i='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>',r='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>',u='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>',f='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>';else var i='<span class="bootstrap-timepicker-hour"><\/span>',r='<span class="bootstrap-timepicker-minute"><\/span>',u='<span class="bootstrap-timepicker-second"><\/span>',f='<span class="bootstrap-timepicker-meridian"><\/span>';n='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-angle-up"><\/i><\/a><\/td><td class="separator">&nbsp;<\/td><td><a href="#" data-action="incrementMinute"><i class="icon-angle-up"><\/i><\/a><\/td>'+(this.showSeconds?'<td class="separator">&nbsp;<\/td><td><a href="#" data-action="incrementSecond"><i class="icon-angle-up"><\/i><\/a><\/td>':"")+(this.showMeridian?'<td class="separator">&nbsp;<\/td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-angle-up"><\/i><\/a><\/td>':"")+"<\/tr><tr><td>"+i+'<\/td> <td class="separator">:<\/td><td>'+r+"<\/td> "+(this.showSeconds?'<td class="separator">:<\/td><td>'+u+"<\/td>":"")+(this.showMeridian?'<td class="separator">&nbsp;<\/td><td>'+f+"<\/td>":"")+'<\/tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-angle-down"><\/i><\/a><\/td><td class="separator"><\/td><td><a href="#" data-action="decrementMinute"><i class="icon-angle-down"><\/i><\/a><\/td>'+(this.showSeconds?'<td class="separator">&nbsp;<\/td><td><a href="#" data-action="decrementSecond"><i class="icon-angle-down"><\/i><\/a><\/td>':"")+(this.showMeridian?'<td class="separator">&nbsp;<\/td><td><a href="#" data-action="toggleMeridian"><i class="icon-angle-down"><\/i><\/a><\/td>':"")+"<\/tr><\/table>";switch(this.options.template){case"modal":t='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×<\/a><h3>Pick a Time<\/h3><\/div><div class="modal-content">'+n+'<\/div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok<\/a><\/div><\/div>';break;case"dropdown":t='<div class="bootstrap-timepicker dropdown-menu">'+n+"<\/div>"}return t}};n.fn.timepicker=function(i){return this.each(function(){var u=n(this),r=u.data("timepicker"),f=typeof i=="object"&&i;r||u.data("timepicker",r=new t(this,f));typeof i=="string"&&r[i]()})};n.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:!1,defaultTime:"current",showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",modalBackdrop:!1,templates:{}};n.fn.timepicker.Constructor=t}(window.jQuery);